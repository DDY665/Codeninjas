# app.py
from flask import Flask, render_template, request
import model

app = Flask(__name__)

# Load the model when the Flask app start # You can call this function here or just load the model when needed

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/predict', methods=['POST'])
def predict():
    # Extract input from the form
    input_data = []
    input_data.append((int)(request.form['input_data2']))
    input_data.append(request.form['input_data1'])
    station_codes = {
    1486: "ALAKNANDA A/C MANDAKINI AT RUDRAPRAYAG",
    1488: "BHAGIRATHI B/C WITH ALAKNANDA AT DEVPRAYAG",
    1487: "ALAKNANDA B/C TO BHAGIRATHI AT DEVPRAYAG",
    1489: "ALAKNANDA A/C WITH BHAGIRATHI AT DEVPRAYAG",
    1060: "GANGA AT RISHIKESH U/S",
    1485: "MANDAKINI B/C ALKALNADA AT RUDRAPRAYAG",
    10147: "RIVER GANGA D/S RISHIKESH",
    2725: "GANGA RIVER AFTER CONFLUENCE OF RIVER SONG NEAR SATYANARAYAN TEMPLE, D/s RAIWALA, DEHRADUN",
    10148: "RIVER GANGA AT HAR KI PAURI GHAT",
    1061: "GANGA AT HARIDWAR D/S, UPPER GANGA CANAL D/S BALKUMARI MANDIR, AJEETPUR, HARIDWAR",
    10150: "RIVER GANGA AT MADHYA GANGA BARRAGE, BIJNOR",
    1062: "GANGA AT GARHMUKTESHWAR, U.P",
    10149: "RIVER GANGA AT GHARMUKTESHWAR",
    2488: "GANGA U/S, ANOOPSHAHAR",
    2489: "GANGA D/S, ANOOPSHAHAR",
    1145: "GANGA AT NARORA (BULANDSAHAR), U.P.",
    10151: "RIVER GANGA AT FARRUKABAD",
    1063: "GANGA AT KANNAUJ U/S (RAJGHAT), U.P",
    1066: "GANGA AT KANNAUJ D/S, U.P",
    1146: "GANGA AT BITHOOR (KANPUR), U.P.",
    1067: "GANGA AT KANPUR U/S (RANIGHAT), U.P",
    10154: "RIVER GANGA AT BATHING GHAT (BHARAOGHAT)",
    10155: "RIVER GANGA AT D/S (SHUKLAGANJ)",
    1068: "GANGA AT KANPUR D/S (JAJMAU PUMPING STATION), U.P",
    10157: "RIVER GANGA AT BATHING GHAT (JAJMAU BRIDGE)",
    1147: "GANGA AT DALMAU (RAI BAREILLY), U.P.",
    2498: "GANGA AT KALA KANKAR, RAEBARELI",
    1046: "GANGA AT ALLAHABAD (RASOOLABAD), U.P.",
    2487: "GANGA AT KADAGHAT, ALLAHABAD",
    1049: "GANGA AT ALLAHABAD D/S (SANGAM), U.P.",
    10158: "RIVER GANGA A/C TAMSA RIVER, SIRSA, SON BARSA",
    2485: "GANGA U/S, VINDHYACHAL, MIRZAPUR",
    2486: "GANGA D/S, MIRZAPUR",
    10153: "RIVER GANGA AT CHUNAR",
    1070: "GANGA AT VARANASI U/S (ASSIGHAT), U.P",
    1071: "GANGA AT VARANASI D/S (MALVIYA BRIDGE), U.P",
    10152: "RIVER GANGA A/C GOMTI RIVER, BHUSAULA",
    10156: "RIVER GANGA AT BATHING GHAT (GOLA GHAT)",
    1073: "GANGA AT TRIGHAT (GHAZIPUR), U.P",
    1074: "GANGA AT BUXAR",
    10113: "RIVER GANGA AT U/S JAIL GHAT, BUXAR",
    2551: "GANGA AT BUXAR, RAMREKHAGHAT",
    3113: "GANGA AT D/S BUXAR NEAR ROAD BRIDGE",
    10131: "RIVER GANGA AT U/S BARAHPUR BINDTOLI",
    10162: "GANGA AT ARA  CHAPRA ROAD BRIDGE (KOILWER BANURA   CHAPRA ROAD",
    2564: "GANGA AT THE CONFLUENCE OF SONE RIVER DORIGANJ, CHAPRA",
    10114: "GANGA AT MAA AMBIKA ASTHAN, AAMI, SARAN",
    3114: "GANGA NEAR DANAPUR (NEAR PIPA PUL) ,PATNA",
    1077: "GANGA AT KURJI, PATNA U/S",
    2552: "GANGA AT GANDHIGHAT, NIT AT PATNA",
    10115: "GANGA AT GULABI GHAT, PATNA",
    1079: "GANGA AT PATNA D/S (GANGA BRIDGE), GAIGHAT",
    3122: "GANGA AT MALSALAMI, PATNA",
    4297: "KACHCHI DARGAH BIDUPUR ROAD BRIDGE, PATNA",
    10122: "RIVER GANGA AT TRIVENI GHAT, PATNA",
    4301: "BAKHTIYARPUR TAJPUR BRIDGE ON GANGA, ATHMALGOLA, PATNA",
    2553: "GANGA AT KEWALA GHAT,FATUHA, PATNA",
    3115: "GANGA RIVER AT BARH",
    10130: "RIVER GANGA AT D/S NAWADAGHAT , BARH ,PATNA",
    1817: "GANGA AT MOKAMA (U/s), MAHADEO ASTHAN, PATNA",
    1815: "GANGA AT MOKAMA (D/s)",
    3123: "GANGA RIVER AT BARAHIYA, NEPALITOLA, MARANCHI, LAKSHISARAI",
    3116: "GANGA AT U/S MUNGER (NEAR INTAKE WELL ON GANGA)",
    1818: "GANGA AT MUNGER",
    3117: "GANGA AT U/S SULTANGANJ, BHAGALPUR",
    2554: "GANGA AT SULTANGANJ, BHAGALPUR",
    10138: "RIVER GANGA AT CHAMPANAGAR, BHAGALPUR",
    1819: "GANGA AT BHAGALPUR",
    3118: "GANGA AT U/S BHAGALPUR NEAR BARARIGHAT",
    1816: "GANGA AT KAHALGAON",
    10143: "RIVER GANGA D/S NEAR CREMATION GHAT",
    10144: "RIVER GANGA U/S NEAR LCT GHAT",
    10145: "RIVER GANGA D/S NEAR JANTA GHAT",
    10146: "RIVER GANGA AT SANGI DALAN",
    1059: "GANGA AT RAJMAHAL",
    1080: "GANGA AT BAHARAMPORE, MURSHIDABAD, WEST BENGAL",
    10159: "RIVER GANGA AT BEHRAMPORE(KHAGRA), MURSHIDABAD",
    10160: "RIVER GANGA AT BEHRAMPORE, (GORA BAZAR),MURSHIDABAD",
    2511: "NABADIP ON GANGA, GHOSHPARA NEAR MONIPURGHAT,NADIA",
    2506: "TRIBENI ON GANGA, NEAR BURNING GHAT, HOOGHLY",
    10161: "RIVER GANGA AT PALTA, SHITALTALA",
    1054: "GANGA AT PALTA WEST BENGAL",
    1472: "GANGA AT SERAMPORE, HOOGHLY,WEST BENGAL",
    1053: "GANGA AT DAKSHMINESHWAR, KOLKATA, WEST BENGAL",
    1471: "GANGA AT HOWRAH SHIVPUR WEST BENGAL",
    1470: "GANGA AT GARDEN REACH, KOLKATA, WEST BENGAL",
    1052: "GANGA AT ULUBERIA , HOWRAH,WEST BENGAL",
    1469: "GANGA AT DIAMOND HARBOUR, 24 PARGANAS (S)WEST BENGAL",
}
    locations_and_states = {
    "BHAGIRATHI AT GANGOTRI": "UTTARAKHAND",
    "ALAKNANDA B/C MANDAKINI AT RUDRA PRAYAG": "UTTARAKHAND",
    "ALAKNANDA A/C MANDAKINI AT RUDRAPRAYAG": "UTTARAKHAND",
    "BHAGIRATHI B/C WITH ALAKNANDA AT DEVPRAYAG": "UTTARAKHAND",
    "ALAKNANDA B/C TO BHAGIRATHI AT DEVPRAYAG": "UTTARAKHAND",
    "ALAKNANDA A/C WITH BHAGIRATHI AT DEVPRAYAG": "UTTARAKHAND",
    "GANGA AT RISHIKESH U/S": "UTTARAKHAND",
    "MANDAKINI B/C ALKALNADA AT RUDRAPRAYAG": "UTTARAKHAND",
    "RIVER GANGA D/S RISHIKESH": "UTTARAKHAND",
    "GANGA RIVER AFTER CONFLUENCE OF RIVER SONG NEAR SATYANARAYAN TEMPLE, D/s RAIWALA, DEHRADUN": "UTTARAKHAND",
    "RIVER GANGA AT HAR KI PAURI GHAT": "UTTARAKHAND",
    "GANGA AT HARIDWAR D/S, UPPER GANGA CANAL D/S BALKUMARI MANDIR, AJEETPUR, HARIDWAR": "UTTARAKHAND",
    "RIVER GANGA AT MADHYA GANGA BARRAGE, BIJNOR": "UTTAR PRADESH",
    "GANGA AT GARHMUKTESHWAR, U.P": "UTTAR PRADESH",
    "RIVER GANGA AT GHARMUKTESHWAR": "UTTAR PRADESH",
    "GANGA U/S, ANOOPSHAHAR": "UTTAR PRADESH",
    "GANGA D/S, ANOOPSHAHAR": "UTTAR PRADESH",
    "GANGA AT NARORA (BULANDSAHAR), U.P.": "UTTAR PRADESH",
    "RIVER GANGA AT FARRUKABAD": "UTTAR PRADESH",
    "GANGA AT KANNAUJ U/S (RAJGHAT), U.P": "UTTAR PRADESH",
    "GANGA AT KANNAUJ D/S, U.P": "UTTAR PRADESH",
    "GANGA AT BITHOOR (KANPUR), U.P.": "UTTAR PRADESH",
    "GANGA AT KANPUR U/S (RANIGHAT), U.P": "UTTAR PRADESH",
    "RIVER GANGA AT BATHING GHAT (BHARAOGHAT)": "UTTAR PRADESH",
    "RIVER GANGA AT D/S (SHUKLAGANJ)": "UTTAR PRADESH",
    "GANGA AT KANPUR D/S (JAJMAU PUMPING STATION), U.P": "UTTAR PRADESH",
    "RIVER GANGA AT BATHING GHAT (JAJMAU BRIDGE)": "UTTAR PRADESH",
    "GANGA AT DALMAU (RAI BAREILLY), U.P.": "UTTAR PRADESH",
    "GANGA AT KALA KANKAR, RAEBARELI": "UTTAR PRADESH",
    "GANGA AT ALLAHABAD (RASOOLABAD), U.P.": "UTTAR PRADESH",
    "GANGA AT KADAGHAT, ALLAHABAD": "UTTAR PRADESH",
    "GANGA AT ALLAHABAD D/S (SANGAM), U.P.": "UTTAR PRADESH",
    "RIVER GANGA A/C TAMSA RIVER, SIRSA, SON BARSA": "UTTAR PRADESH",
    "GANGA U/S, VINDHYACHAL, MIRZAPUR": "UTTAR PRADESH",
    "GANGA D/S, MIRZAPUR": "UTTAR PRADESH",
    "RIVER GANGA AT CHUNAR": "UTTAR PRADESH",
    "GANGA AT VARANASI U/S (ASSIGHAT), U.P": "UTTAR PRADESH",
    "GANGA AT VARANASI D/S (MALVIYA BRIDGE), U.P": "UTTAR PRADESH",
    "RIVER GANGA A/C GOMTI RIVER, BHUSAULA": "UTTAR PRADESH",
    "RIVER GANGA AT BATHING GHAT (GOLA GHAT)": "UTTAR PRADESH",
    "GANGA AT TRIGHAT (GHAZIPUR), U.P": "UTTAR PRADESH",
    "GANGA AT BUXAR": "BIHAR",
    "RIVER GANGA AT U/S JAIL GHAT, BUXAR": "BIHAR",
    "GANGA AT BUXAR, RAMREKHAGHAT": "BIHAR",
    "GANGA AT D/S BUXAR NEAR ROAD BRIDGE": "BIHAR",
    "RIVER GANGA AT U/S BARAHPUR BINDTOLI": "BIHAR",
    "GANGA AT ARA  CHAPRA ROAD BRIDGE (KOILWER BANURA   CHAPRA ROAD": "BIHAR",
    "GANGA AT THE CONFLUENCE OF SONE RIVER DORIGANJ, CHAPRA": "BIHAR",
    "GANGA AT MAA AMBIKA ASTHAN, AAMI, SARAN": "BIHAR",
    "GANGA NEAR DANAPUR (NEAR PIPA PUL) ,PATNA": "BIHAR",
    "GANGA AT KURJI, PATNA U/S": "BIHAR",
    "GANGA AT GANDHIGHAT, NIT AT PATNA": "BIHAR",
    "GANGA AT GULABI GHAT, PATNA": "BIHAR",
    "GANGA AT PATNA D/S (GANGA BRIDGE), GAIGHAT": "BIHAR",
    "GANGA AT MALSALAMI, PATNA": "BIHAR",
    "KACHCHI DARGAH BIDUPUR ROAD BRIDGE, PATNA": "BIHAR",
    "RIVER GANGA AT TRIVENI GHAT, PATNA": "BIHAR",
    "BAKHTIYARPUR TAJPUR BRIDGE ON GANGA, ATHMALGOLA, PATNA": "BIHAR",
    "GANGA AT KEWALA GHAT,FATUHA, PATNA": "BIHAR",
    "GANGA RIVER AT BARH": "BIHAR",
    "RIVER GANGA AT D/S NAWADAGHAT , BARH ,PATNA": "BIHAR",
    "GANGA AT MOKAMA (U/s), MAHADEO ASTHAN, PATNA": "BIHAR",
    "GANGA AT MOKAMA (D/s)": "BIHAR",
    "GANGA RIVER AT BARAHIYA, NEPALITOLA, MARANCHI, LAKSHISARAI": "BIHAR",
    "GANGA AT U/S MUNGER (NEAR INTAKE WELL ON GANGA)": "BIHAR",
    "GANGA AT MUNGER": "BIHAR",
    "GANGA AT U/S SULTANGANJ, BHAGALPUR": "BIHAR",
    "GANGA AT SULTANGANJ, BHAGALPUR": "BIHAR",
    "RIVER GANGA AT CHAMPANAGAR, BHAGALPUR": "BIHAR",
    "GANGA AT BHAGALPUR": "BIHAR",
    "GANGA AT U/S BHAGALPUR NEAR BARARIGHAT": "BIHAR",
    "GANGA AT KAHALGAON": "BIHAR",
    "RIVER GANGA D/S NEAR CREMATION GHAT": "BIHAR",
    "RIVER GANGA U/S NEAR LCT GHAT": "BIHAR",
    "RIVER GANGA D/S NEAR JANTA GHAT": "BIHAR",
    "RIVER GANGA AT SANGI DALAN": "BIHAR",
    "GANGA AT RAJMAHAL": "JHARKHAND",
    "GANGA AT BAHARAMPORE, MURSHIDABAD, WEST BENGAL": "WEST BENGAL",
    "RIVER GANGA AT BEHRAMPORE(KHAGRA), MURSHIDABAD": "WEST BENGAL",
    "RIVER GANGA AT BEHRAMPORE, (GORA BAZAR),MURSHIDABAD": "WEST BENGAL",
    "NABADIP ON GANGA, GHOSHPARA NEAR MONIPURGHAT,NADIA": "WEST BENGAL",
    "TRIBENI ON GANGA, NEAR BURNING GHAT, HOOGHLY": "WEST BENGAL",
    "RIVER GANGA AT PALTA, SHITALTALA": "WEST BENGAL",
    "GANGA AT PALTA WEST BENGAL": "WEST BENGAL",
    "GANGA AT SERAMPORE, HOOGHLY,WEST BENGAL": "WEST BENGAL",
    "GANGA AT DAKSHMINESHWAR, KOLKATA, WEST BENGAL": "WEST BENGAL",
    "GANGA AT HOWRAH SHIVPUR WEST BENGAL": "WEST BENGAL",
    "GANGA AT GARDEN REACH, KOLKATA, WEST BENGAL": "WEST BENGAL",
    "GANGA AT ULUBERIA , HOWRAH,WEST BENGAL": "WEST BENGAL",
    "GANGA AT DIAMOND HARBOUR, 24 PARGANAS (S)WEST BENGAL": "WEST BENGAL"
    }
    in_data2 = locations_and_states[input_data[1]]
    equator = {'BIHAR':0, 'JHARKHAND':1,'UTTAR PRADESH':3 ,'UTTARAKHAND':3 ,'WEST BENGAL':4}
    input_data.append(equator[in_data2])
    for i in station_codes:
        if(station_codes[i]==input_data[1]):
            input_data[1] = i
            break
    rf_model = model.load_and_train_model()
    # Make a prediction using the trained model
    prediction = model.predict(input_data)
    ans = (prediction[2])*3 + (prediction[0])*2.5 + (prediction[1])*2 + (prediction[3])*2.5
    
    # # Render result on the page
    return render_template('index.html', prediction=ans)

if __name__ == '__main__':
    app.run(debug=True)
